# Практическая работа №3

## Задание
Вариант 4.

 - Необходимо использовать модуль numpy
 - Все данные должны считываться из файла в виде массива numpy
 - Результаты необходимо сохранять в файл

Написать функцию, которая заполняет матрицу с размерами (M,N) случайными числами распределенными по нормальному закону. 
Затем считает мат. ожидание и дисперсию для каждого из столбцов, 
а также строит для каждой строки стоит гистограмму значений 
(использовать функцию hist из модуля matplotlib.plot).


## Реализация

Подключим необходимые зависимости, для построения гистограммы будем использовать модуль `seaborn`
```python3
from functools import reduce

import pandas as pd
import numpy as np
import seaborn as sns
from matplotlib import pyplot as plt

# np.random.seed(42)
sns.set_theme()
sns.color_palette("crest", as_cmap=True)
```
Считаем размер генерируемой матрицы из файла:
```python3
shape = np.fromfile("data/input.csv", dtype=int, sep=";")
assert all(map(lambda x: x > 0, shape)), "n m must be positive integers"
```

Сгенерируем матрицу, заполненную числами из N(0,1) и вычислим требуемые метрики:
```python3
matrix = np.random.normal(0, 1, shape)
col_mean, col_variance = (lambda axis: (fn(matrix, axis=axis) for fn in (np.mean, np.var)))(0)
```

Сохраним полученные данные в файл:
```python3
print(f"Generated matrix is:\n{matrix}\nMean vector:\n{col_mean}\nVariance vector:\n{col_variance}")
with open("data/output.txt", "w") as fout:
    fout.write(f"{matrix}\n{col_mean}\n{col_variance}")
```

Подготовим датафрейм для построения диаграммы:
```python3
count = reduce(lambda x, y: x * y, shape, 1)
rows = len(matrix)
df = pd.DataFrame({"row": matrix.reshape(count, ), "row_index": np.repeat(range(rows), count // rows)})
```

И, собственно, строим гистограмму:
```python3
sns.displot(df, x="row", hue="row_index", binwidth=0.1, stat="density")
plt.savefig('data/hist.png')
plt.show()
```

## Вывод программы

Пусть в файле `data/input.csv` находится строка `10;10`. Пусть seed равен 42.
Вывод программы представлен ниже.
```
Generated matrix is:
[[ 0.49671415 -0.1382643   0.64768854  1.52302986 -0.23415337 -0.23413696
   1.57921282  0.76743473 -0.46947439  0.54256004]
 [-0.46341769 -0.46572975  0.24196227 -1.91328024 -1.72491783 -0.56228753
  -1.01283112  0.31424733 -0.90802408 -1.4123037 ]
 [ 1.46564877 -0.2257763   0.0675282  -1.42474819 -0.54438272  0.11092259
  -1.15099358  0.37569802 -0.60063869 -0.29169375]
 [-0.60170661  1.85227818 -0.01349722 -1.05771093  0.82254491 -1.22084365
   0.2088636  -1.95967012 -1.32818605  0.19686124]
 [ 0.73846658  0.17136828 -0.11564828 -0.3011037  -1.47852199 -0.71984421
  -0.46063877  1.05712223  0.34361829 -1.76304016]
 [ 0.32408397 -0.38508228 -0.676922    0.61167629  1.03099952  0.93128012
  -0.83921752 -0.30921238  0.33126343  0.97554513]
 [-0.47917424 -0.18565898 -1.10633497 -1.19620662  0.81252582  1.35624003
  -0.07201012  1.0035329   0.36163603 -0.64511975]
 [ 0.36139561  1.53803657 -0.03582604  1.56464366 -2.6197451   0.8219025
   0.08704707 -0.29900735  0.09176078 -1.98756891]
 [-0.21967189  0.35711257  1.47789404 -0.51827022 -0.8084936  -0.50175704
   0.91540212  0.32875111 -0.5297602   0.51326743]
 [ 0.09707755  0.96864499 -0.70205309 -0.32766215 -0.39210815 -1.46351495
   0.29612028  0.26105527  0.00511346 -0.23458713]]
Mean vector:
[ 0.17194162  0.3486929  -0.02152086 -0.30396322 -0.51362525 -0.14820391
 -0.04490452  0.15399517 -0.27026914 -0.41060796]
Variance vector:
[0.37442767 0.6145547  0.48520648 1.29247825 1.29446536 0.79481117
 0.67228711 0.69178488 0.30869865 0.94719069]
```

Построим гистограммы для случаев, когда столбцов >50, чтобы убедиться в корректности генерируемых данных

| ![](https://imgur.com/ICkTDJh.png) |
|:---:|
| Гистограмма для случая 5;1000 |

| ![](https://imgur.com/OE5RTZi.png) |
|:---:|
| Гистограмма для случая 5;10000000 |

